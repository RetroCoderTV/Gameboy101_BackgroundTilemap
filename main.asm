/*
Barebones background tilemap display
"Hello World"
*/

INCLUDE "inc/hardware.inc"

SECTION "Header",ROM0[$100]
    jp Game

    DS $150 - @,0

SECTION "Game",rom0[$150]

Game:

.WaitVBlank:
	ld a, [rLY]
	cp 144
	jp c, WaitVBlank

    ;reset important registers
	xor	a
	ld	[rIF],a
	ld	[rLCDC],a
	ld	[rSTAT],a
	ld	[rSCX],a
	ld	[rSCY],a
	ld	[rLYC],a
	ld	[rIE],a

    ;palette
    ld	a,%11100100			
	ld	[rBGP],a			
	ld	[rOBP0],a			
	ld	[rOBP1],a

    ; Copy the tile data
	ld de, BG_Tiles
	ld hl, $9000
	ld bc, BG_TilesEnd - BG_Tiles
:
	ld a, [de]
	ld [hli], a
	inc de
	dec bc
	ld a, b
	or a, c
	jp nz, :-

	; Copy the tilemap
	ld de, BG_Tilemap
	ld hl, _SCRN0
	ld bc, BG_TilemapEnd - BG_Tilemap
:
	ld a, [de]
	ld [hli], a
	inc de
	dec bc
	ld a, b
	or a, c
	jp nz, :-

	; Turn the LCD on
	ld a, LCDCF_ON | LCDCF_BGON
	ld [rLCDC], a

.gameloop:
    jr .gameloop


SECTION "Helper Routines",ROM0

;-------------------------------------------------------------------------------
fill::
;-------------------------------------------------------------------------------
; a - byte to fill with
; hl - destination address
; bc - size of area to fill
    
    inc	b
    inc	c
    jr	.skip
.fill
ld	[hl+],a
.skip
    dec	c
    jr	nz,.fill
    dec	b
    jr	nz,.fill
    ret

SECTION "BG Tiles", ROM0

BG_Tiles:
    DB $FF,$00,$FF,$00,$FF,$00,$FF,$00,$FF,$03,$FE,$06,$FC,$0C,$F8,$18
    DB $FF,$00,$FF,$00,$FF,$00,$FF,$7F,$C0,$C0,$00,$00,$00,$00,$00,$00
    DB $FF,$00,$FF,$00,$FF,$00,$FF,$FF,$00,$00,$00,$00,$00,$00,$00,$00
    DB $FF,$00,$FF,$00,$FF,$00,$FF,$F0,$1F,$1E,$03,$03,$01,$01,$00,$00
    DB $FF,$00,$FF,$00,$FF,$00,$FF,$00,$FF,$00,$FF,$00,$FF,$80,$FF,$C0
    DB $FF,$00,$FF,$00,$FF,$00,$FF,$00,$FF,$00,$FF,$00,$FF,$00,$FF,$00
    DB $F3,$30,$E3,$23,$E3,$21,$E2,$63,$C3,$40,$C3,$43,$C3,$41,$C2,$43
    DB $FC,$44,$B8,$FC,$FC,$10,$EC,$FC,$FC,$44,$B8,$FC,$FC,$10,$EC,$FC
    DB $03,$00,$03,$03,$03,$01,$02,$03,$03,$00,$03,$03,$03,$01,$02,$03
    DB $FF,$44,$BB,$FF,$FF,$11,$EE,$FF,$FF,$44,$BB,$FF,$FF,$11,$EE,$FF
    DB $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
    DB $7F,$60,$2F,$30,$27,$38,$37,$38,$17,$18,$13,$1C,$13,$1C,$13,$1C
    DB $C3,$40,$C3,$43,$C3,$41,$C2,$43,$C3,$40,$C3,$43,$C3,$41,$C2,$43
    DB $13,$1C,$13,$1C,$13,$1C,$13,$1C,$13,$1C,$13,$1C,$13,$1C,$13,$1C
    DB $C0,$40,$C0,$40,$C0,$40,$C0,$40,$C0,$40,$C0,$40,$C0,$40,$C0,$40
    DB $C0,$40,$C0,$40,$C0,$40,$C0,$40,$E0,$60,$E0,$20,$E0,$20,$F0,$30
    DB $13,$1C,$13,$1C,$13,$1C,$13,$1C,$33,$3C,$23,$3C,$23,$3C,$67,$78
    DB $F8,$18,$FC,$0C,$FE,$06,$FF,$03,$FE,$01,$FF,$00,$FF,$00,$FF,$00
    DB $00,$00,$00,$00,$00,$00,$C0,$C0,$7F,$FF,$00,$FF,$E0,$1F,$FF,$00
    DB $00,$00,$00,$00,$00,$00,$00,$00,$FF,$FF,$00,$FF,$00,$FF,$FF,$00
    DB $00,$00,$00,$00,$00,$00,$00,$00,$FE,$FE,$02,$FE,$04,$FC,$FC,$04
    DB $00,$00,$00,$00,$00,$00,$00,$00,$03,$03,$02,$03,$04,$07,$04,$07
    DB $00,$00,$00,$00,$00,$00,$00,$00,$FF,$FF,$00,$FF,$00,$FF,$7F,$80
    DB $00,$00,$01,$01,$03,$03,$1E,$1F,$F0,$FF,$00,$FF,$03,$FC,$FF,$00
    DB $C7,$F8,$87,$F8,$0F,$F0,$1F,$E0,$3F,$C0,$7F,$80,$FF,$00,$FF,$00
    DB $FF,$00,$FF,$00,$FF,$00,$FF,$00,$FF,$00,$FF,$00,$FF,$00,$FF,$03
    DB $F8,$08,$F8,$08,$F0,$10,$E0,$20,$E0,$20,$C0,$40,$80,$80,$00,$00
    DB $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$01,$01
    DB $00,$00,$00,$00,$00,$00,$00,$00,$03,$03,$0C,$0F,$30,$3F,$C0,$FF
    DB $08,$0F,$10,$1F,$21,$3E,$C3,$FC,$07,$F8,$0F,$F0,$3F,$C0,$FF,$00
    DB $FF,$00,$FF,$00,$FF,$00,$FF,$00,$FF,$01,$FE,$06,$F8,$18,$FF,$1F
    DB $FC,$04,$F8,$08,$F0,$30,$C0,$40,$80,$80,$00,$00,$01,$01,$FE,$FF
    DB $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$03,$03,$FC,$FF,$00,$FF
    DB $00,$00,$00,$00,$00,$00,$00,$00,$07,$07,$F8,$FF,$00,$FF,$01,$FE
    DB $00,$00,$00,$00,$07,$07,$78,$7F,$80,$FF,$01,$FE,$1F,$E0,$FF,$00
    DB $0E,$0F,$70,$7F,$80,$FF,$03,$FC,$1F,$E0,$FF,$00,$FF,$00,$FF,$00
    DB $03,$FC,$0F,$F0,$7F,$80,$FF,$00,$FF,$00,$FF,$00,$FF,$00,$FF,$00
    DB $F8,$07,$F8,$07,$FF,$00,$FF,$00,$FF,$00,$FF,$00,$FF,$00,$FF,$00
    DB $00,$FF,$00,$FF,$FF,$00,$FF,$00,$FF,$00,$FF,$00,$FF,$00,$FF,$00
    DB $00,$FF,$7F,$80,$FF,$00,$FF,$00,$FF,$00,$FF,$00,$FF,$00,$FF,$00
BG_TilesEnd:
    

SECTION "BG BG_Tilemap", ROM0
    
BG_Tilemap:
    DB $00,$01,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02
    DB $02,$02,$03,$04,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $06,$07,$08,$07,$08,$09,$07,$08,$07,$0A,$0A,$08,$07,$0A,$0A,$08
    DB $09,$09,$07,$0B,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $0C,$07,$08,$07,$08,$07,$0A,$08,$07,$0A,$0A,$08,$07,$0A,$0A,$08
    DB $07,$08,$07,$0D,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $0C,$09,$09,$07,$08,$09,$07,$08,$07,$0A,$0A,$08,$07,$0A,$0A,$08
    DB $07,$08,$07,$0D,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $0C,$07,$08,$07,$08,$07,$0A,$08,$07,$0A,$0A,$08,$07,$0A,$0A,$08
    DB $07,$08,$07,$0D,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $0C,$07,$08,$07,$08,$09,$07,$08,$09,$09,$07,$08,$09,$09,$07,$08
    DB $09,$09,$07,$0D,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $0E,$0A,$0A,$0A,$0A,$0A,$0A,$0A,$0A,$0A,$0A,$0A,$0A,$0A,$0A,$0A
    DB $0A,$0A,$0A,$0D,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $0C,$07,$08,$07,$08,$09,$09,$07,$08,$09,$07,$0A,$08,$07,$0A,$08
    DB $09,$07,$0A,$0D,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $0C,$07,$08,$07,$08,$07,$08,$07,$08,$07,$08,$07,$08,$07,$0A,$08
    DB $07,$08,$07,$0D,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $0C,$07,$08,$07,$08,$07,$08,$07,$08,$09,$07,$0A,$08,$07,$0A,$08
    DB $07,$08,$07,$0D,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $0C,$09,$09,$07,$08,$07,$08,$07,$08,$07,$08,$07,$08,$07,$0A,$08
    DB $07,$08,$07,$0D,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $0C,$07,$08,$07,$08,$09,$09,$07,$08,$07,$08,$07,$08,$09,$07,$08
    DB $09,$07,$0A,$0D,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $0F,$0A,$0A,$0A,$0A,$0A,$0A,$0A,$0A,$0A,$0A,$0A,$0A,$0A,$0A,$0A
    DB $0A,$0A,$0A,$10,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $11,$12,$13,$13,$13,$13,$13,$13,$13,$13,$13,$14,$0A,$0A,$0A,$0A
    DB $15,$16,$17,$18,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$19,$1A,$0A,$0A,$1B,$1C
    DB $1D,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$1E,$1F,$20,$21,$22,$23,$24
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$25,$26,$27,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    DB $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
BG_TilemapEnd: